{"version":3,"file":"MBWay.js","sources":["../../../../src/components/MBWay/MBWay.tsx"],"sourcesContent":["import { h } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport MBWayInput from './components/MBWayInput';\nimport config from './components/MBWayAwait/config';\nimport { Await } from '../../components/internal/Await';\nimport SRPanelProvider from '../../core/Errors/SRPanelProvider';\nimport { TxVariants } from '../tx-variants';\nimport { AwaitConfiguration } from '../internal/Await/types';\n\nexport class MBWayElement extends UIElement<AwaitConfiguration> {\n    public static type = TxVariants.mbway;\n\n    formatProps(props) {\n        const { data = {}, placeholders = {} } = props;\n\n        return {\n            ...props,\n            data: {\n                phoneNumber: data.telephoneNumber || data.phoneNumber,\n                phonePrefix: data.phonePrefix || '+351' // if not specified default to Portuguese country code\n            },\n            placeholders: {\n                phoneNumber: placeholders.telephoneNumber || placeholders.phoneNumber\n            }\n        };\n    }\n\n    /**\n     * Formats the component data output\n     */\n    formatData(): object {\n        return {\n            paymentMethod: {\n                type: MBWayElement.type,\n                ...(this.state.data?.phoneNumber && { telephoneNumber: this.state.data.phonePrefix + this.state.data.phoneNumber })\n            }\n        };\n    }\n\n    get isValid(): boolean {\n        return !!this.state.isValid;\n    }\n\n    get displayName(): string {\n        return this.props.name;\n    }\n\n    protected override componentToRender(): h.JSX.Element {\n        if (this.props.paymentData) {\n            return (\n                <SRPanelProvider srPanel={this.props.modules.srPanel}>\n                    <Await\n                        clientKey={this.props.clientKey}\n                        paymentData={this.props.paymentData}\n                        onError={this.props.onError}\n                        onComplete={this.onComplete}\n                        brandLogo={this.icon}\n                        type={config.type}\n                        messageText={this.props.i18n.get(config.messageTextId)}\n                        awaitText={this.props.i18n.get(config.awaitTextId)}\n                        showCountdownTimer={config.showCountdownTimer}\n                        delay={config.STATUS_INTERVAL}\n                        countdownTime={config.COUNTDOWN_MINUTES}\n                        throttleTime={config.THROTTLE_TIME}\n                        throttleInterval={config.THROTTLE_INTERVAL}\n                        onActionHandled={this.onActionHandled}\n                    />\n                </SRPanelProvider>\n            );\n        }\n\n        return (\n            <MBWayInput\n                /* @ts-ignore ref handled internally by Component */\n                ref={ref => {\n                    this.componentRef = ref;\n                }}\n                {...this.props}\n                setComponentRef={this.setComponentRef}\n                onChange={this.setState}\n                onSubmit={this.submit}\n                payButton={this.payButton}\n            />\n        );\n    }\n}\n\nexport default MBWayElement;\n"],"names":["MBWayElement","UIElement","formatProps","props","data","placeholders","_object_spread_props","_object_spread","phoneNumber","telephoneNumber","phonePrefix","formatData","_this_state_data","paymentMethod","type","this","state","isValid","displayName","name","componentToRender","paymentData","h","SRPanelProvider","srPanel","modules","Await","clientKey","onError","onComplete","brandLogo","icon","config","messageText","i18n","get","messageTextId","awaitText","awaitTextId","showCountdownTimer","delay","STATUS_INTERVAL","countdownTime","COUNTDOWN_MINUTES","throttleTime","THROTTLE_TIME","throttleInterval","THROTTLE_INTERVAL","onActionHandled","MBWayInput","ref","componentRef","setComponentRef","onChange","setState","onSubmit","submit","payButton","_define_property","TxVariants","mbway"],"mappings":"yqCASO,MAAMA,UAAqBC,EAG9BC,WAAAA,CAAYC,GACR,MAAMC,KAAEA,EAAO,CAAA,EAAEC,aAAEA,EAAe,CAAA,GAAOF,EAEzC,OAAOG,EAAAC,EAAA,CAAA,EACAJ,GAAAA,CACHC,KAAM,CACFI,YAAaJ,EAAKK,iBAAmBL,EAAKI,YAC1CE,YAAaN,EAAKM,aAAe,QAErCL,aAAc,CACVG,YAAaH,EAAaI,iBAAmBJ,EAAaG,cAGtE,CAKAG,UAAAA,GAIgB,IAAAC,EAHZ,MAAO,CACHC,cAAeN,EAAA,CACXO,KAAMd,EAAac,OACA,QAAfF,EAAAG,KAAKC,MAAMZ,YAAX,IAAAQ,OAAA,EAAAA,EAAiBJ,cAAe,CAAEC,gBAAiBM,KAAKC,MAAMZ,KAAKM,YAAcK,KAAKC,MAAMZ,KAAKI,cAGjH,CAEA,WAAIS,GACA,QAASF,KAAKC,MAAMC,OACxB,CAEA,eAAIC,GACA,OAAOH,KAAKZ,MAAMgB,IACtB,CAEmBC,iBAAAA,GACf,OAAIL,KAAKZ,MAAMkB,YAEPC,EAACC,EAAAA,CAAgBC,QAAST,KAAKZ,MAAMsB,QAAQD,SACzCF,EAACI,EAAAA,CACGC,UAAWZ,KAAKZ,MAAMwB,UACtBN,YAAaN,KAAKZ,MAAMkB,YACxBO,QAASb,KAAKZ,MAAMyB,QACpBC,WAAYd,KAAKc,WACjBC,UAAWf,KAAKgB,KAChBjB,KAAMkB,EAAOlB,KACbmB,YAAalB,KAAKZ,MAAM+B,KAAKC,IAAIH,EAAOI,eACxCC,UAAWtB,KAAKZ,MAAM+B,KAAKC,IAAIH,EAAOM,aACtCC,mBAAoBP,EAAOO,mBAC3BC,MAAOR,EAAOS,gBACdC,cAAeV,EAAOW,kBACtBC,aAAcZ,EAAOa,cACrBC,iBAAkBd,EAAOe,kBACzBC,gBAAiBjC,KAAKiC,mBAOlC1B,EAAC2B,EAAAA,EAAAA,EAAAA,CAEGC,IAAKA,IACDnC,KAAKoC,aAAeD,IAEpBnC,KAAKZ,OAAK,CACdiD,gBAAiBrC,KAAKqC,gBACtBC,SAAUtC,KAAKuC,SACfC,SAAUxC,KAAKyC,OACfC,UAAW1C,KAAK0C,YAG5B,EA1EAC,EADS1D,EACKc,OAAO6C,EAAWC"}