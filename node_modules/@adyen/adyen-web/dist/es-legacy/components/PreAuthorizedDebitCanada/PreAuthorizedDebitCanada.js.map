{"version":3,"file":"PreAuthorizedDebitCanada.js","sources":["../../../../src/components/PreAuthorizedDebitCanada/PreAuthorizedDebitCanada.tsx"],"sourcesContent":["import { h, Fragment } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { TxVariants } from '../tx-variants';\nimport PreAuthorizedDebitCanadaComponent from './components/PreAuthorizedDebitCanadaComponent';\nimport { SettlementInfo } from './components/SettlementInfo';\nimport RedirectButton from '../internal/RedirectButton';\nimport { payAmountLabel } from '../internal/PayButton';\n\nimport type { PreAuthorizedDebitCanadaConfiguration } from './types';\n\nexport class PreAuthorizedDebitCanada extends UIElement<PreAuthorizedDebitCanadaConfiguration> {\n    public static type = TxVariants.eft_directdebit_CA;\n\n    public override formatData() {\n        const recurringPayment = !!this.props.storedPaymentMethodId;\n\n        if (recurringPayment) {\n            return {\n                paymentMethod: {\n                    type: PreAuthorizedDebitCanada.type,\n                    storedPaymentMethodId: this.props.storedPaymentMethodId\n                }\n            };\n        }\n\n        return {\n            paymentMethod: {\n                type: PreAuthorizedDebitCanada.type,\n                ownerName: this.state.data.ownerName,\n                bankAccountNumber: this.state.data.bankAccountNumber,\n                bankCode: this.state.data.bankCode,\n                bankLocationId: this.state.data.bankLocationId\n            },\n            ...(this.state.storePaymentMethod && { storePaymentMethod: this.state.storePaymentMethod })\n        };\n    }\n\n    public override formatProps(props: PreAuthorizedDebitCanadaConfiguration): PreAuthorizedDebitCanadaConfiguration {\n        return {\n            enableStoreDetails: props.session?.configuration?.enableStoreDetails ?? props.enableStoreDetails,\n            ...props\n        };\n    }\n\n    public override get isValid(): boolean {\n        if (this.props.storedPaymentMethodId) {\n            return true;\n        }\n\n        return !!this.state.isValid;\n    }\n\n    public override get displayName(): string {\n        if (this.props.storedPaymentMethodId && this.props.lastFour) {\n            return `•••• ${this.props.lastFour}`;\n        }\n\n        return this.props.name;\n    }\n\n    public override get additionalInfo(): string {\n        return this.props.storedPaymentMethodId ? this.props.label : '';\n    }\n\n    protected override componentToRender(): h.JSX.Element {\n        return this.props.storedPaymentMethodId ? (\n            <Fragment>\n                <SettlementInfo />\n                <RedirectButton\n                    showPayButton={this.props.showPayButton}\n                    icon={this.resources?.getImage({ imageFolder: 'components/' })(`bento_lock`)}\n                    label={payAmountLabel(this.props.i18n, this.props.amount)}\n                    name={this.displayName}\n                    amount={this.props.amount}\n                    payButton={this.payButton}\n                    onSubmit={this.submit}\n                    ref={ref => {\n                        this.componentRef = ref;\n                    }}\n                />\n            </Fragment>\n        ) : (\n            <PreAuthorizedDebitCanadaComponent\n                onChange={this.setState}\n                payButton={this.payButton}\n                showPayButton={this.props.showPayButton}\n                placeholders={this.props.placeholders}\n                setComponentRef={this.setComponentRef}\n                showContextualElement={this.props.showContextualElement}\n                enableStoreDetails={this.props.enableStoreDetails}\n            />\n        );\n    }\n}\n\nexport default PreAuthorizedDebitCanada;\n"],"names":["PreAuthorizedDebitCanada","UIElement","formatData","this","props","storedPaymentMethodId","paymentMethod","type","_object_spread","ownerName","state","data","bankAccountNumber","bankCode","bankLocationId","storePaymentMethod","formatProps","enableStoreDetails","session","configuration","isValid","displayName","lastFour","name","additionalInfo","label","componentToRender","_this_resources","h","Fragment","SettlementInfo","RedirectButton","showPayButton","icon","resources","getImage","imageFolder","payAmountLabel","i18n","amount","payButton","onSubmit","submit","ref","componentRef","PreAuthorizedDebitCanadaComponent","onChange","setState","placeholders","setComponentRef","showContextualElement","_define_property","TxVariants","eft_directdebit_CA"],"mappings":"08BAUO,MAAMA,UAAiCC,EAG1BC,UAAAA,GAGZ,QAF2BC,KAAKC,MAAMC,sBAG3B,CACHC,cAAe,CACXC,KAAMP,EAAyBO,KAC/BF,sBAAuBF,KAAKC,MAAMC,wBAKvCG,EAAA,CACHF,cAAe,CACXC,KAAMP,EAAyBO,KAC/BE,UAAWN,KAAKO,MAAMC,KAAKF,UAC3BG,kBAAmBT,KAAKO,MAAMC,KAAKC,kBACnCC,SAAUV,KAAKO,MAAMC,KAAKE,SAC1BC,eAAgBX,KAAKO,MAAMC,KAAKG,iBAEhCX,KAAKO,MAAMK,oBAAsB,CAAEA,mBAAoBZ,KAAKO,MAAMK,oBAE9E,CAEgBC,WAAAA,CAAYZ,OAEAA,EAAAA,EAAAA,EADxB,OAAOI,EAAA,CACHS,2BAAoBb,EAAa,QAAbA,EAAAA,EAAMc,mBAANd,GAA4B,QAA5BA,EAAAA,EAAee,yBAAff,SAAAA,EAA8Ba,0BAA9Bb,IAAAA,EAAAA,EAAoDA,EAAMa,oBAC3Eb,EAEX,CAEA,WAAoBgB,GAChB,QAAIjB,KAAKC,MAAMC,yBAINF,KAAKO,MAAMU,OACxB,CAEA,eAAoBC,GAChB,OAAIlB,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMkB,SACxC,QAAQnB,KAAKC,MAAMkB,WAGvBnB,KAAKC,MAAMmB,IACtB,CAEA,kBAAoBC,GAChB,OAAOrB,KAAKC,MAAMC,sBAAwBF,KAAKC,MAAMqB,MAAQ,EACjE,CAEmBC,iBAAAA,GAMG,IAAAC,EALlB,OAAOxB,KAAKC,MAAMC,sBACduB,EAACC,EAAAA,KACGD,EAACE,EAAAA,MACDF,EAACG,EAAAA,CACGC,cAAe7B,KAAKC,MAAM4B,cAC1BC,KAAoB,QAAdN,EAAAxB,KAAK+B,iBAAL,IAAAP,OAAA,EAAAA,EAAgBQ,SAAS,CAAEC,YAAa,eAAxCT,CAAyD,cAC/DF,MAAOY,EAAelC,KAAKC,MAAMkC,KAAMnC,KAAKC,MAAMmC,QAClDhB,KAAMpB,KAAKkB,YACXkB,OAAQpC,KAAKC,MAAMmC,OACnBC,UAAWrC,KAAKqC,UAChBC,SAAUtC,KAAKuC,OACfC,IAAKA,IACDxC,KAAKyC,aAAeD,MAKhCf,EAACiB,EAAAA,CACGC,SAAU3C,KAAK4C,SACfP,UAAWrC,KAAKqC,UAChBR,cAAe7B,KAAKC,MAAM4B,cAC1BgB,aAAc7C,KAAKC,MAAM4C,aACzBC,gBAAiB9C,KAAK8C,gBACtBC,sBAAuB/C,KAAKC,MAAM8C,sBAClCjC,mBAAoBd,KAAKC,MAAMa,oBAG3C,EAjFAkC,EADSnD,EACKO,OAAO6C,EAAWC"}