{"version":3,"file":"utils.js","sources":["../../../../../src/core/ProcessResponse/PaymentMethods/utils.ts"],"sourcesContent":["import { RawPaymentMethod, PaymentMethodsResponse, RawStoredPaymentMethod } from '../../../types/global-types';\nimport {\n    filterAllowedPaymentMethods,\n    filterEcomStoredPaymentMethods,\n    filterRemovedPaymentMethods,\n    filterSupportedStoredPaymentMethods\n} from './filters';\nimport uuidv4 from '../../../utils/uuid';\nimport type { PaymentMethod } from './PaymentMethods';\n\nconst processStoredPaymentMethod = (pm): RawStoredPaymentMethod => ({\n    ...pm,\n    storedPaymentMethodId: pm.id,\n    isStoredPaymentMethod: true\n});\n\n/**\n * Generate unique ID per payment method. Useful to fetch the correct payment method properties from the response\n * @param paymentMethod\n */\nfunction generatePaymentMethodId(paymentMethod: RawPaymentMethod): PaymentMethod {\n    return {\n        ...paymentMethod,\n        _id: uuidv4()\n    };\n}\n\nexport const processPaymentMethods = (\n    paymentMethods: RawPaymentMethod[],\n    { allowPaymentMethods = [], removePaymentMethods = [] }\n): PaymentMethod[] => {\n    if (!paymentMethods) return [];\n\n    return paymentMethods\n        .filter(filterAllowedPaymentMethods, allowPaymentMethods)\n        .filter(filterRemovedPaymentMethods, removePaymentMethods)\n        .map(generatePaymentMethodId);\n};\n\nexport const processStoredPaymentMethods = (\n    storedPaymentMethods: RawStoredPaymentMethod[],\n    { allowPaymentMethods = [], removePaymentMethods = [] }\n): RawStoredPaymentMethod[] => {\n    if (!storedPaymentMethods) return [];\n\n    return storedPaymentMethods\n        .filter(filterSupportedStoredPaymentMethods) // only display supported stored payment methods\n        .filter(filterAllowedPaymentMethods, allowPaymentMethods)\n        .filter(filterRemovedPaymentMethods, removePaymentMethods)\n        .filter(filterEcomStoredPaymentMethods) // Only accept Ecommerce shopper interactions\n        .map(processStoredPaymentMethod);\n};\n\nexport const checkPaymentMethodsResponse = (paymentMethodsResponse: PaymentMethodsResponse) => {\n    if (typeof paymentMethodsResponse === 'string') {\n        throw new Error(\n            'paymentMethodsResponse was provided but of an incorrect type (should be an object but a string was provided).' +\n                'Try JSON.parse(\"{...}\") your paymentMethodsResponse.'\n        );\n    }\n\n    if (paymentMethodsResponse instanceof Array) {\n        throw new Error(\n            'paymentMethodsResponse was provided but of an incorrect type (should be an object but an array was provided).' +\n                'Please check you are passing the whole response.'\n        );\n    }\n\n    if (paymentMethodsResponse && !paymentMethodsResponse?.paymentMethods?.length && !paymentMethodsResponse?.storedPaymentMethods?.length) {\n        console.warn('paymentMethodsResponse was provided but no payment methods were found.');\n    }\n};\n"],"names":["processStoredPaymentMethod","pm","storedPaymentMethodId","id","isStoredPaymentMethod","generatePaymentMethodId","paymentMethod","_id","uuidv4","processPaymentMethods","paymentMethods","allowPaymentMethods","removePaymentMethods","filter","filterAllowedPaymentMethods","filterRemovedPaymentMethods","map","processStoredPaymentMethods","storedPaymentMethods","filterSupportedStoredPaymentMethods","filterEcomStoredPaymentMethods","checkPaymentMethodsResponse","paymentMethodsResponse","Error","Array","length","console","warn"],"mappings":"+MAUA,MAAMA,EAA8BC,IAAAA,IAC7BA,EACHC,sBAAuBD,EAAGE,GAC1BC,uBAAuB,IAO3B,SAASC,EAAwBC,GAC7B,MAAO,IACAA,EACHC,IAAKC,IAEb,CAEO,MAAMC,EAAwB,CACjCC,GACEC,sBAAsB,GAAIC,uBAAuB,MAE9CF,EAEEA,EACFG,OAAOC,EAA6BH,GACpCE,OAAOE,EAA6BH,GACpCI,IAAIX,GALmB,GAQnBY,EAA8B,CACvCC,GACEP,sBAAsB,GAAIC,uBAAuB,MAE9CM,EAEEA,EACFL,OAAOM,GACPN,OAAOC,EAA6BH,GACpCE,OAAOE,EAA6BH,GACpCC,OAAOO,GACPJ,IAAIhB,GAPyB,GAUzBqB,EAA+BC,IACxC,GAAsC,iBAA3BA,EACP,MAAM,IAAIC,MACN,qKAKR,GAAID,aAAkCE,MAClC,MAAM,IAAID,MACN,kKAKJD,GAA2BA,GAAwBZ,gBAAgBe,QAAWH,GAAwBJ,sBAAsBO,QAC5HC,QAAQC,KAAK"}