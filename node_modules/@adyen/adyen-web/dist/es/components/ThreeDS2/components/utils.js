import{CHALLENGE_WINDOW_SIZES as e,DEFAULT_CHALLENGE_WINDOW_SIZE as t}from"../constants.js";import{getOrigin as r}from"../../../utils/getOrigin.js";import n from"../../../utils/base64.js";import{pick as s}from"../../../utils/commonUtils.js";const a=e=>"success"in e&&!e.success,o=e=>{const t=n.decode(e);if(t.success)try{return JSON.parse(t.data)}catch(e){return{success:!1,error:"Could not JSON parse token"}}return t},i=e=>{if(!e||!Object.keys(e).length)throw new Error("No (populated) data object to encode");return n.encode(JSON.stringify(e))},c=r=>{const n=1===r.length?`0${r}`:r;return Object.prototype.hasOwnProperty.call(e,n)?n:t},l=t=>e[c(t)],p=({token:e,size:t})=>{const n=o(e);if(a(n))return n;const{acsTransID:s,acsURL:i,messageVersion:p,threeDSNotificationURL:d,threeDSServerTransID:m}=n,u=r(d);return{acsURL:i,cReqData:{acsTransID:s,messageVersion:p,threeDSServerTransID:m,messageType:"CReq",challengeWindowSize:c(t)},iframeSizeArr:l(t),postMessageDomain:u}},d=({token:e,notificationURL:t})=>{const n=o(e);if(a(n))return n;const{threeDSMethodNotificationURL:s,threeDSMethodUrl:i,threeDSServerTransID:c}=n,l=t||s;return{threeDSServerTransID:c,threeDSMethodURL:i,threeDSMethodNotificationURL:l,postMessageDomain:r(l)}},m=(e,t,r)=>({data:{[e]:i({threeDSCompInd:t.threeDSCompInd}),paymentData:r}}),u=(e,t,r)=>({data:{details:{"threeds2.fingerprint":i(t)},paymentData:r}}),h=(e,t,r)=>({data:{details:{[e]:i({transStatus:t,authorisationToken:r})}}}),D=(e,t,r)=>({data:{details:{"threeds2.challengeResult":i({transStatus:t})},paymentData:r}}),S=e=>{let t=window.btoa(e).split("=")[0];return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t},f=["elementRef"],g=["createFromAction","onAdditionalDetails"],R=(e,t)=>{if("fingerprint"===e){const e=t.elementRef?f:g,r=s(e).from(t);return r.showSpinner=!t.isDropin,r.statusType="loading",r}return{statusType:"custom",i18n:t.i18n,elementRef:t.elementRef}};export{h as createChallengeResolveData,m as createFingerprintResolveData,D as createOldChallengeResolveData,u as createOldFingerprintResolveData,o as decodeAndParseToken,S as encodeBase64URL,i as encodeObject,R as get3DS2FlowProps,l as getChallengeWindowSize,a as isErrorObject,p as prepareChallengeData,d as prepareFingerPrintData,c as validateChallengeWindowSize};
//# sourceMappingURL=utils.js.map
