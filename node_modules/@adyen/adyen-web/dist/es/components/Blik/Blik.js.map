{"version":3,"file":"Blik.js","sources":["../../../../src/components/Blik/Blik.tsx"],"sourcesContent":["import { h } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport BlikInput from '../../components/Blik/components/BlikInput';\nimport { Await } from '../internal/Await';\nimport config from './config';\nimport RedirectButton from '../../components/internal/RedirectButton';\nimport SRPanelProvider from '../../core/Errors/SRPanelProvider';\nimport { TxVariants } from '../tx-variants';\nimport { AwaitConfiguration } from '../internal/Await/types';\n\ninterface BlikElementData {\n    paymentMethod: {\n        type: string;\n        blikCode: string;\n    };\n}\n\nclass BlikElement extends UIElement<AwaitConfiguration> {\n    public static type = TxVariants.blik;\n\n    formatData(): BlikElementData {\n        const recurringPayment = !!this.props.storedPaymentMethodId;\n\n        return {\n            paymentMethod: {\n                type: BlikElement.type,\n                ...(!recurringPayment && { blikCode: this.state?.data?.blikCode }),\n                ...(recurringPayment && { storedPaymentMethodId: this.props.storedPaymentMethodId })\n            }\n        };\n    }\n\n    get isValid(): boolean {\n        if (this.props.storedPaymentMethodId) {\n            return true;\n        }\n\n        return !!this.state.isValid;\n    }\n\n    get displayName() {\n        if (this.props.storedPaymentMethodId && this.props.label) {\n            return this.props.label;\n        }\n        return this.props.name;\n    }\n\n    get additionalInfo() {\n        if (this.props.storedPaymentMethodId && this.props.label) {\n            return this.props.name;\n        }\n        return null;\n    }\n\n    /**\n     * NOTE: for future reference:\n     *  this.props.onComplete (which is called from this.onComplete) equates to the merchant defined onAdditionalDetails callback\n     *  (the initial /payments response defines an \"await\" action, actionTypes.ts translates this to \"onComplete: props.onAdditionalDetails\")\n     */\n    protected override componentToRender(): h.JSX.Element {\n        if (this.props.paymentData) {\n            return (\n                <SRPanelProvider srPanel={this.props.modules.srPanel}>\n                    <Await\n                        clientKey={this.props.clientKey}\n                        paymentData={this.props.paymentData}\n                        onError={this.handleError}\n                        onComplete={this.onComplete}\n                        brandLogo={this.icon}\n                        type={config.type}\n                        messageText={this.props.i18n.get(config.messageTextId)}\n                        awaitText={this.props.i18n.get(config.awaitTextId)}\n                        showCountdownTimer={config.showCountdownTimer}\n                        delay={config.STATUS_INTERVAL}\n                        countdownTime={config.COUNTDOWN_MINUTES}\n                        throttleTime={config.THROTTLE_TIME}\n                        throttleInterval={config.THROTTLE_INTERVAL}\n                        onActionHandled={this.onActionHandled}\n                    />\n                </SRPanelProvider>\n            );\n        }\n\n        return this.props.storedPaymentMethodId ? (\n            <RedirectButton\n                showPayButton={this.props.showPayButton}\n                name={this.displayName}\n                amount={this.props.amount}\n                payButton={this.payButton}\n                onSubmit={this.submit}\n                ref={ref => {\n                    this.componentRef = ref;\n                }}\n            />\n        ) : (\n            <BlikInput\n                // @ts-ignore Ref is used by preact component\n                ref={ref => {\n                    this.componentRef = ref;\n                }}\n                {...this.props}\n                onChange={this.setState}\n                onSubmit={this.submit}\n                payButton={this.payButton}\n            />\n        );\n    }\n}\n\nexport default BlikElement;\n"],"names":["BlikElement","UIElement","formatData","recurringPayment","this","props","storedPaymentMethodId","paymentMethod","type","blikCode","state","data","isValid","displayName","label","name","additionalInfo","componentToRender","paymentData","h","SRPanelProvider","srPanel","modules","Await","clientKey","onError","handleError","onComplete","brandLogo","icon","config","messageText","i18n","get","messageTextId","awaitText","awaitTextId","showCountdownTimer","delay","STATUS_INTERVAL","countdownTime","COUNTDOWN_MINUTES","throttleTime","THROTTLE_TIME","throttleInterval","THROTTLE_INTERVAL","onActionHandled","RedirectButton","showPayButton","amount","payButton","onSubmit","submit","ref","componentRef","BlikInput","onChange","setState","TxVariants","blik"],"mappings":"0ZAiBA,MAAMA,UAAoBC,EAGtBC,UAAAA,GACI,MAAMC,IAAqBC,KAAKC,MAAMC,sBAEtC,MAAO,CACHC,cAAe,CACXC,KAAMR,EAAYQ,SACbL,GAAoB,CAAEM,SAAUL,KAAKM,OAAOC,MAAMF,aACnDN,GAAoB,CAAEG,sBAAuBF,KAAKC,MAAMC,wBAGxE,CAEA,WAAIM,GACA,QAAIR,KAAKC,MAAMC,yBAINF,KAAKM,MAAME,OACxB,CAEA,eAAIC,GACA,OAAIT,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMS,MACxCV,KAAKC,MAAMS,MAEfV,KAAKC,MAAMU,IACtB,CAEA,kBAAIC,GACA,OAAIZ,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMS,MACxCV,KAAKC,MAAMU,KAEf,IACX,CAOA,iBAAAE,GACI,OAAIb,KAAKC,MAAMa,YAEPC,EAACC,EAAAA,CAAgBC,QAASjB,KAAKC,MAAMiB,QAAQD,SACzCF,EAACI,EAAAA,CACGC,UAAWpB,KAAKC,MAAMmB,UACtBN,YAAad,KAAKC,MAAMa,YACxBO,QAASrB,KAAKsB,YACdC,WAAYvB,KAAKuB,WACjBC,UAAWxB,KAAKyB,KAChBrB,KAAMsB,EAAOtB,KACbuB,YAAa3B,KAAKC,MAAM2B,KAAKC,IAAIH,EAAOI,eACxCC,UAAW/B,KAAKC,MAAM2B,KAAKC,IAAIH,EAAOM,aACtCC,mBAAoBP,EAAOO,mBAC3BC,MAAOR,EAAOS,gBACdC,cAAeV,EAAOW,kBACtBC,aAAcZ,EAAOa,cACrBC,iBAAkBd,EAAOe,kBACzBC,gBAAiB1C,KAAK0C,mBAM/B1C,KAAKC,MAAMC,sBACda,EAAC4B,EAAAA,CACGC,cAAe5C,KAAKC,MAAM2C,cAC1BjC,KAAMX,KAAKS,YACXoC,OAAQ7C,KAAKC,MAAM4C,OACnBC,UAAW9C,KAAK8C,UAChBC,SAAU/C,KAAKgD,OACfC,IAAKA,IACDjD,KAAKkD,aAAeD,KAI5BlC,EAACoC,EAAAA,CAEGF,IAAKA,IACDjD,KAAKkD,aAAeD,MAEpBjD,KAAKC,MACTmD,SAAUpD,KAAKqD,SACfN,SAAU/C,KAAKgD,OACfF,UAAW9C,KAAK8C,WAG5B,cAzFElD,IACYQ,SAAOkD,EAAWC"}