{"version":3,"file":"AmazonPayComponent.js","sources":["../../../../../src/components/AmazonPay/components/AmazonPayComponent.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { useState, useEffect, useRef } from 'preact/hooks';\nimport Spinner from '../../internal/Spinner';\nimport { getAmazonPayUrl } from '../utils';\nimport { AmazonPayComponentProps } from '../types';\nimport AmazonPayButton from './AmazonPayButton';\nimport ChangePaymentDetailsButton from './ChangePaymentDetailsButton';\nimport OrderButton from './OrderButton';\nimport SignOutButton from './SignOutButton';\nimport Script from '../../../utils/Script';\nimport useAnalytics from '../../../core/Analytics/useAnalytics';\n\nexport default function AmazonPayComponent(props: AmazonPayComponentProps) {\n    const [status, setStatus] = useState('pending');\n    const amazonPayButtonRef = useRef(null);\n    const orderButtonRef = useRef(null);\n    const { analytics } = useAnalytics();\n\n    const handleLoad = () => {\n        setStatus('ready');\n    };\n\n    this.getSubmitFunction = () => {\n        if (amazonPayButtonRef.current && amazonPayButtonRef.current.initCheckout) return () => amazonPayButtonRef.current.initCheckout();\n        if (orderButtonRef.current && orderButtonRef.current.createOrder) return () => orderButtonRef.current.createOrder();\n    };\n\n    useEffect(() => {\n        const src = getAmazonPayUrl(props.configuration.region);\n        const script = new Script({\n            src,\n            component: 'amazonpay',\n            analytics\n        });\n\n        if (window.amazon) {\n            handleLoad();\n        } else {\n            void script.load().then(handleLoad);\n        }\n\n        return () => {\n            script.remove();\n        };\n    }, [analytics]);\n\n    if (status === 'pending') {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                <div className=\"adyen-checkout__amazonpay__status adyen-checkout__amazonpay__status--pending\">\n                    <Spinner />\n                </div>\n            </div>\n        );\n    }\n\n    if (props.showSignOutButton) {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                <SignOutButton amazonRef={window.amazon} onSignOut={props.onSignOut} />\n            </div>\n        );\n    }\n\n    if (props.amazonCheckoutSessionId) {\n        return (\n            <div className=\"adyen-checkout__amazonpay\">\n                {props.showOrderButton && (\n                    <OrderButton\n                        amazonCheckoutSessionId={props.amazonCheckoutSessionId}\n                        amount={props.amount}\n                        chargePermissionType={props.chargePermissionType}\n                        recurringMetadata={props.recurringMetadata}\n                        clientKey={props.clientKey}\n                        onError={props.onError}\n                        publicKeyId={props.configuration?.publicKeyId}\n                        region={props.configuration?.region}\n                        returnUrl={props.returnUrl}\n                        ref={orderButtonRef}\n                    />\n                )}\n\n                {props.showChangePaymentDetailsButton && (\n                    <ChangePaymentDetailsButton amazonCheckoutSessionId={props.amazonCheckoutSessionId} amazonRef={window.amazon} />\n                )}\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"adyen-checkout__amazonpay\">\n            <AmazonPayButton {...props} showPayButton={this.props.showPayButton} amazonRef={window.amazon} ref={amazonPayButtonRef} />\n        </div>\n    );\n}\n"],"names":["AmazonPayComponent","props","status","setStatus","useState","amazonPayButtonRef","useRef","orderButtonRef","analytics","useAnalytics","handleLoad","this","getSubmitFunction","current","initCheckout","createOrder","useEffect","src","getAmazonPayUrl","configuration","region","script","Script","component","window","amazon","load","then","remove","h","div","className","Spinner","showSignOutButton","SignOutButton","amazonRef","onSignOut","amazonCheckoutSessionId","showOrderButton","OrderButton","amount","chargePermissionType","recurringMetadata","clientKey","onError","publicKeyId","returnUrl","ref","showChangePaymentDetailsButton","ChangePaymentDetailsButton","AmazonPayButton","showPayButton"],"mappings":"m+BAYe,SAASA,EAAmBC,GACvC,MAAOC,EAAQC,GAAaC,EAAS,WAC/BC,EAAqBC,EAAO,MAC5BC,EAAiBD,EAAO,OACxBE,UAAEA,GAAcC,IAEhBC,EAAa,KACfP,EAAU,UA2Bd,OAxBAQ,KAAKC,kBAAoB,IACjBP,EAAmBQ,SAAWR,EAAmBQ,QAAQC,aAAqB,IAAMT,EAAmBQ,QAAQC,eAC/GP,EAAeM,SAAWN,EAAeM,QAAQE,YAAoB,IAAMR,EAAeM,QAAQE,mBAAtG,EAGJC,EAAU,KACN,MAAMC,EAAMC,EAAgBjB,EAAMkB,cAAcC,QAC1CC,EAAS,IAAIC,EAAO,CACtBL,MACAM,UAAW,YACXf,cASJ,OANIgB,OAAOC,OACPf,IAEKW,EAAOK,OAAOC,KAAKjB,GAGrB,KACHW,EAAOO,WAEZ,CAACpB,IAEW,YAAXN,EAEI2B,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACC,MAAAA,CAAIC,UAAU,gFACXF,EAACG,EAAAA,QAMb/B,EAAMgC,kBAEFJ,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACK,EAAAA,CAAcC,UAAWX,OAAOC,OAAQW,UAAWnC,EAAMmC,aAKlEnC,EAAMoC,wBAEFR,EAACC,MAAAA,CAAIC,UAAU,6BACV9B,EAAMqC,iBACHT,EAACU,EAAAA,CACGF,wBAAyBpC,EAAMoC,wBAC/BG,OAAQvC,EAAMuC,OACdC,qBAAsBxC,EAAMwC,qBAC5BC,kBAAmBzC,EAAMyC,kBACzBC,UAAW1C,EAAM0C,UACjBC,QAAS3C,EAAM2C,QACfC,YAAgC,QAAnB5C,EAAAA,EAAMkB,qBAANlB,IAAAA,OAAAA,EAAAA,EAAqB4C,YAClCzB,OAA2B,QAAnBnB,EAAAA,EAAMkB,qBAANlB,IAAAA,OAAAA,EAAAA,EAAqBmB,OAC7B0B,UAAW7C,EAAM6C,UACjBC,IAAKxC,IAIZN,EAAM+C,gCACHnB,EAACoB,EAAAA,CAA2BZ,wBAAyBpC,EAAMoC,wBAAyBF,UAAWX,OAAOC,UAOlHI,EAACC,MAAAA,CAAIC,UAAU,6BACXF,EAACqB,EAAAA,oUAAAA,CAAAA,CAAAA,EAAoBjD,GAAAA,CAAOkD,cAAexC,KAAKV,MAAMkD,cAAehB,UAAWX,OAAOC,OAAQsB,IAAK1C,UAhB3EJ,EACLA,CAkBhC"}